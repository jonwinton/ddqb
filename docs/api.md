<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# ddqb

```go
import "github.com/jonwinton/ddqb"
```

Package ddqb provides a fluent API for building Datadog queries.

Package ddqb provides a fluent API for building Datadog queries.

<details><summary>Example</summary>
<p>



```go
package main

import (
	"fmt"
	"log"

	"github.com/jonwinton/ddqb"
)

func main() {
	// Create a simple metric query
	query, err := ddqb.Metric().
		Metric("system.cpu.idle").
		Build()
	if err != nil {
		log.Fatalf("Failed to build query: %v", err)
	}
	fmt.Println(query)

	// Create a metric query with aggregation
	query, err = ddqb.Metric().
		Aggregator("avg").
		TimeWindow("5m").
		Metric("system.cpu.idle").
		Build()
	if err != nil {
		log.Fatalf("Failed to build query: %v", err)
	}
	fmt.Println(query)

	// Create a metric query with filtering
	query, err = ddqb.Metric().
		Metric("system.cpu.idle").
		Filter(ddqb.Filter("host").Equal("web-1")).
		Build()
	if err != nil {
		log.Fatalf("Failed to build query: %v", err)
	}
	fmt.Println(query)

	// Create a complex metric query
	query, err = ddqb.Metric().
		Aggregator("avg").
		TimeWindow("5m").
		Metric("system.cpu.idle").
		Filter(ddqb.Filter("host").Equal("web-1")).
		Filter(ddqb.Filter("env").Equal("prod")).
		GroupBy("host").
		ApplyFunction(ddqb.Function("fill").WithArg("0")).
		ApplyFunction(ddqb.Function("rollup").WithArgs("60", "sum")).
		Build()
	if err != nil {
		log.Fatalf("Failed to build query: %v", err)
	}
	fmt.Println(query)

}
```

#### Output

```
system.cpu.idle{*}
avg(5m):system.cpu.idle{*}
system.cpu.idle{host:web-1}
avg(5m):system.cpu.idle{host:web-1, env:prod} by {host}.fill(0).rollup(60, sum)
```

</p>
</details>

## Index

- [func Filter\(key string\) metric.FilterBuilder](<#Filter>)
- [func FilterGroup\(\) metric.FilterGroupBuilder](<#FilterGroup>)
- [func FromQuery\(queryString string\) \(metric.QueryBuilder, error\)](<#FromQuery>)
- [func Function\(name string\) metric.FunctionBuilder](<#Function>)
- [func Metric\(\) metric.QueryBuilder](<#Metric>)
- [type Builder](<#Builder>)
- [type Renderer](<#Renderer>)


<a name="Filter"></a>
## func [Filter](<https://github.com/jonwinton/ddqb/blob/main/ddqb.go#L14>)

```go
func Filter(key string) metric.FilterBuilder
```

Filter creates a new filter builder with the given key. This is a convenience function for creating filter builders.

<a name="FilterGroup"></a>
## func [FilterGroup](<https://github.com/jonwinton/ddqb/blob/main/ddqb.go#L26>)

```go
func FilterGroup() metric.FilterGroupBuilder
```

FilterGroup creates a new filter group builder. This is a convenience function for creating filter group builders.

<a name="FromQuery"></a>
## func [FromQuery](<https://github.com/jonwinton/ddqb/blob/main/ddqb.go#L40>)

```go
func FromQuery(queryString string) (metric.QueryBuilder, error)
```

FromQuery parses an existing Datadog query string and returns a QueryBuilder that can be modified using the fluent API.

Example:

```
builder, err := ddqb.FromQuery("avg(5m):system.cpu.idle{host:web-1} by {host}.fill(0)")
if err != nil {
	// handle error
}
modifiedQuery, err := builder.TimeWindow("10m").Filter(ddqb.Filter("env").Equal("prod")).Build()
```

<a name="Function"></a>
## func [Function](<https://github.com/jonwinton/ddqb/blob/main/ddqb.go#L20>)

```go
func Function(name string) metric.FunctionBuilder
```

Function creates a new function builder with the given name. This is a convenience function for creating function builders.

<a name="Metric"></a>
## func [Metric](<https://github.com/jonwinton/ddqb/blob/main/ddqb.go#L8>)

```go
func Metric() metric.QueryBuilder
```

Metric creates a new metric query builder. This is the main entry point for building metric queries.

<a name="Builder"></a>
## type [Builder](<https://github.com/jonwinton/ddqb/blob/main/builder.go#L6-L9>)

Builder is the base interface for all query builders. It defines the methods that all builders must implement.

```go
type Builder interface {
    // Build returns the built query as a string.
    Build() (string, error)
}
```

<a name="Renderer"></a>
## type [Renderer](<https://github.com/jonwinton/ddqb/blob/main/builder.go#L12-L15>)

Renderer defines an interface for objects that can render themselves as Datadog query strings.

```go
type Renderer interface {
    // String returns the object as a Datadog query string.
    String() string
}
```

# debug

```go
import "github.com/jonwinton/ddqb/debug"
```

## Index



# metric

```go
import "github.com/jonwinton/ddqb/metric"
```

Package metric provides builders for creating Datadog metric queries.

## Index

- [type FilterBuilder](<#FilterBuilder>)
  - [func NewFilterBuilder\(key string\) FilterBuilder](<#NewFilterBuilder>)
- [type FilterExpression](<#FilterExpression>)
- [type FilterGroupBuilder](<#FilterGroupBuilder>)
  - [func NewFilterGroupBuilder\(\) FilterGroupBuilder](<#NewFilterGroupBuilder>)
- [type FilterOperation](<#FilterOperation>)
- [type FunctionBuilder](<#FunctionBuilder>)
  - [func NewFunctionBuilder\(name string\) FunctionBuilder](<#NewFunctionBuilder>)
- [type GroupOperator](<#GroupOperator>)
- [type QueryBuilder](<#QueryBuilder>)
  - [func NewMetricQueryBuilder\(\) QueryBuilder](<#NewMetricQueryBuilder>)
  - [func ParseQuery\(queryString string\) \(QueryBuilder, error\)](<#ParseQuery>)


<a name="FilterBuilder"></a>
## type [FilterBuilder](<https://github.com/jonwinton/ddqb/blob/main/metric/filter.go#L33-L50>)

FilterBuilder provides a fluent interface for building filter conditions. FilterBuilder implements FilterExpression.

```go
type FilterBuilder interface {
    FilterExpression

    // Equal creates an equality filter (key:value).
    Equal(value string) FilterBuilder

    // NotEqual creates a negated equality filter (!key:value).
    NotEqual(value string) FilterBuilder

    // Regex creates a regex filter (key:~value).
    Regex(pattern string) FilterBuilder

    // In creates an IN filter.
    In(values ...string) FilterBuilder

    // NotIn creates a NOT IN filter.
    NotIn(values ...string) FilterBuilder
}
```

<a name="NewFilterBuilder"></a>
### func [NewFilterBuilder](<https://github.com/jonwinton/ddqb/blob/main/metric/filter.go#L60>)

```go
func NewFilterBuilder(key string) FilterBuilder
```

NewFilterBuilder creates a new filter builder with the given key.

<a name="FilterExpression"></a>
## type [FilterExpression](<https://github.com/jonwinton/ddqb/blob/main/metric/filter.go#L10-L13>)

FilterExpression is a common interface for both individual filters and filter groups. This allows QueryBuilder to accept either FilterBuilder or FilterGroupBuilder instances.

```go
type FilterExpression interface {
    // Build returns the built filter expression as a string.
    Build() (string, error)
}
```

<a name="FilterGroupBuilder"></a>
## type [FilterGroupBuilder](<https://github.com/jonwinton/ddqb/blob/main/metric/filter_group.go#L20-L31>)

FilterGroupBuilder provides a fluent interface for building filter groups with boolean logic. FilterGroupBuilder implements FilterExpression.

```go
type FilterGroupBuilder interface {
    FilterExpression

    // And adds a filter or nested group with AND operator.
    And(expr FilterExpression) FilterGroupBuilder

    // Or adds a filter or nested group with OR operator.
    Or(expr FilterExpression) FilterGroupBuilder

    // Not negates the entire group (wraps in NOT (...)).
    Not() FilterGroupBuilder
}
```

<a name="NewFilterGroupBuilder"></a>
### func [NewFilterGroupBuilder](<https://github.com/jonwinton/ddqb/blob/main/metric/filter_group.go#L41>)

```go
func NewFilterGroupBuilder() FilterGroupBuilder
```

NewFilterGroupBuilder creates a new filter group builder.

<a name="FilterOperation"></a>
## type [FilterOperation](<https://github.com/jonwinton/ddqb/blob/main/metric/filter.go#L16>)

FilterOperation represents the type of filter operation.

```go
type FilterOperation int
```

<a name="Equal"></a>

```go
const (
    // Equal represents an equality filter (key:value).
    Equal FilterOperation = iota
    // NotEqual represents a negated equality filter (!key:value).
    NotEqual
    // Regex represents a regex filter (key:~value).
    Regex
    // In represents an IN filter.
    In
    // NotIn represents a NOT IN filter.
    NotIn
)
```

<a name="FunctionBuilder"></a>
## type [FunctionBuilder](<https://github.com/jonwinton/ddqb/blob/main/metric/function.go#L9-L18>)

FunctionBuilder provides a fluent interface for building functions to apply to queries.

```go
type FunctionBuilder interface {
    // WithArg adds an argument to the function.
    WithArg(arg string) FunctionBuilder

    // WithArgs adds multiple arguments to the function.
    WithArgs(args ...string) FunctionBuilder

    // Build returns the built function as a string.
    Build() (string, error)
}
```

<a name="NewFunctionBuilder"></a>
### func [NewFunctionBuilder](<https://github.com/jonwinton/ddqb/blob/main/metric/function.go#L27>)

```go
func NewFunctionBuilder(name string) FunctionBuilder
```

NewFunctionBuilder creates a new function builder with the given name.

<a name="GroupOperator"></a>
## type [GroupOperator](<https://github.com/jonwinton/ddqb/blob/main/metric/filter_group.go#L9>)

GroupOperator represents the boolean operator used in a filter group.

```go
type GroupOperator int
```

<a name="AndOperator"></a>

```go
const (
    // AndOperator represents an AND operation between filters.
    AndOperator GroupOperator = iota
    // OrOperator represents an OR operation between filters.
    OrOperator
)
```

<a name="QueryBuilder"></a>
## type [QueryBuilder](<https://github.com/jonwinton/ddqb/blob/main/metric/metric.go#L10-L43>)

QueryBuilder provides a fluent interface for building metric queries.

```go
type QueryBuilder interface {
    // Metric sets the metric name for the query.
    Metric(name string) QueryBuilder

    // Aggregator sets the aggregation method for the query (e.g., "avg", "sum").
    Aggregator(agg string) QueryBuilder

    // Filter adds a filter condition or filter group to the query.
    Filter(filter FilterExpression) QueryBuilder

    // GetFilters returns all filter expressions in the query.
    // This allows direct access to modify FilterGroupBuilder instances.
    GetFilters() []FilterExpression

    // FindGroup finds the first FilterGroupBuilder that matches the predicate function.
    // Returns nil if no matching group is found.
    FindGroup(predicate func(FilterGroupBuilder) bool) FilterGroupBuilder

    // AddToGroup adds a filter to the specified FilterGroupBuilder.
    // The filter is added using the group's existing operator (AND or OR).
    AddToGroup(group FilterGroupBuilder, filter FilterExpression) QueryBuilder

    // GroupBy sets grouping parameters for the query.
    GroupBy(groups ...string) QueryBuilder

    // ApplyFunction applies a function to the query.
    ApplyFunction(fn FunctionBuilder) QueryBuilder

    // TimeWindow sets the time window for the query (e.g., "1m", "5m").
    TimeWindow(window string) QueryBuilder

    // Build returns the built query as a string.
    Build() (string, error)
}
```

<a name="NewMetricQueryBuilder"></a>
### func [NewMetricQueryBuilder](<https://github.com/jonwinton/ddqb/blob/main/metric/metric.go#L56>)

```go
func NewMetricQueryBuilder() QueryBuilder
```

NewMetricQueryBuilder creates a new metric query builder.

<a name="ParseQuery"></a>
### func [ParseQuery](<https://github.com/jonwinton/ddqb/blob/main/metric/parser.go#L13>)

```go
func ParseQuery(queryString string) (QueryBuilder, error)
```

ParseQuery parses a Datadog query string and returns a QueryBuilder that can be modified using the fluent API.

# advanced

```go
import "github.com/jonwinton/ddqb/examples/advanced"
```

Package main demonstrates advanced usage of ddqb, including dynamic query building based on runtime conditions.

## Index



# basic

```go
import "github.com/jonwinton/ddqb/examples/basic"
```

Package main demonstrates basic usage examples of ddqb for building Datadog metric queries.

## Index



# filters

```go
import "github.com/jonwinton/ddqb/examples/filters"
```

Package main demonstrates various filter operations available in ddqb for Datadog metric queries.

## Index



# functions

```go
import "github.com/jonwinton/ddqb/examples/functions"
```

Package main demonstrates how to apply functions to Datadog metric queries using ddqb.

## Index



# parse

```go
import "github.com/jonwinton/ddqb/examples/parse"
```

Package main demonstrates parsing existing Datadog query strings and modifying them using ddqb.

## Index



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
